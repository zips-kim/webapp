{% extends "layout.html" %}

{% block title %}ğŸ  ìœ ì„±ì‰˜í„° (Shelter-On){% endblock %}

{% block content %}

    <div style="padding:20px; max-width: 500px; margin: 0 auto;">
		<div class="card backup-card p-25 mb-20">
			<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
				<h3 class="mt-0" style="color: #0050b3;">ğŸ“¦ í”„ë¡œì íŠ¸ ë°±ì—…</h3>
				<a href="/download_project" class="btn-base btn-download">í˜„ì¬ ì†ŒìŠ¤ ì••ì¶• (.zip)</a>
			</div>
			<p style="font-size: 12px; color: #666; margin: 0;">
				â€» í˜„ì¬ ì„œë²„ì—ì„œ êµ¬ë™ ì¤‘ì¸ ì†ŒìŠ¤ ì½”ë“œ, í…œí”Œë¦¿, ë°ì´í„°ë² ì´ìŠ¤ ë“± ìµœìƒìœ„ í´ë”ì˜ ëª¨ë“  íŒŒì¼ì„ ZIPìœ¼ë¡œ ì••ì¶•í•˜ì—¬ ë‚´ë ¤ë°›ìŠµë‹ˆë‹¤.
			</p>
		</div>

        <div class="card upload-dropzone p-25 mb-20">
			<h3 class="mt-0" style="color: #2c3e50;">ğŸ› ï¸ ê°œë°œ í™˜ê²½ íŒŒì¼ ì „ì†¡</h3>
			
			<form action="/upload_files" method="post" enctype="multipart/form-data">
				<div class="mb-15">
					<select name="upload_folder_select" class="form-input form-input-light">
						{% for folder in folders %}
						<option value="{{ folder.value }}">{{ folder.display }}</option>
						{% endfor %}
					</select>
				</div>

				<div class="mb-15">
					<label class="text-bold mb-5" style="display:block; font-size:14px;">ì§ì ‘ ì…ë ¥ (ì‹ ê·œ í´ë” ìƒì„± ì‹œ)</label>
					<input type="text" name="upload_folder_direct" placeholder="ì„ íƒ ëª©ë¡ì— ì—†ëŠ” ê²½ë¡œ ì…ë ¥ ì‹œ ì‘ì„±" class="form-input">
				</div>
				
				<div class="mb-20">
					<label class="text-bold mb-5" style="display:block; font-size:14px;">íŒŒì¼ ì„ íƒ</label>
					<input type="file" name="files" multiple class="form-input">
				</div>
				
				<button type="submit" class="btn-base btn-primary w-100" style="font-size: 16px;">ğŸš€ íŒŒì¼ ì„œë²„ë¡œ ì „ì†¡</button>
			</form>
		</div>
		
		{% with messages = get_flashed_messages() %}
          {% if messages %}
            {% for message in messages %}
              <div id="flash-msg" class="flash-msg-box">{{ message }}</div>
            {% endfor %}
            <script>
                setTimeout(function() {
                    var msg = document.getElementById('flash-msg');
                    if(msg) msg.style.display = 'none';
                }, 2000);
            </script>
          {% endif %}
        {% endwith %}
		
		<div class="card p-25">
			<h3 class="mt-0">ğŸ“‚ ì„œë²„ íŒŒì¼ ê´€ë¦¬</h3>
			<div class="mb-15">
				<select onchange="location.href='/upload?folder=' + this.value" class="form-input" style="background: #fffbe6; border-color: #ffe58f;">
					{% for folder in folders %}
					<option value="{{ folder.value }}" {% if folder.value == current_folder %}selected{% endif %}>{{ folder.display }}</option>
					{% endfor %}
				</select>
			</div>

			{% if files %}
			<ul class="file-list">
				{% for file in files %}
				<li class="file-item">
					<span style="font-size: 14px; color: #333;">ğŸ“„ {{ file }}</span>
					<div style="display: flex; gap: 5px;">
						<a href="{{ url_for('download_file', folder_path=current_folder if current_folder else 'root', filename=file) }}" class="btn-base btn-success btn-sm">ë‹¤ìš´ë¡œë“œ</a>
						<a href="{{ url_for('delete_file', folder_path=current_folder if current_folder else 'root', filename=file) }}" 
						   onclick="return confirm('ì •ë§ ì´ íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');" class="btn-base btn-danger btn-sm">ì‚­ì œ</a>
					</div>
				</li>
				{% endfor %}
			</ul>
			{% endif %}
		</div>
    </div>
{% endblock %}